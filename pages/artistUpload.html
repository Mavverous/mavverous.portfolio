<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Art & Design Portfolio of MAVVEROUS - Mars">
    <title>MAVVEROUS | Upload Artwork</title>
    <link rel="icon" href="../resources/images/logo.png" type="image/png">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Ms+Madi&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Manjari:wght@100;400;700&display=swap" rel="stylesheet">

    <!-- AOS Animation Library -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../resources/css/style.css">
    <link rel="stylesheet" href="../resources/css/card-effects.css">
    
    <style>
        .preview-image { max-width: 300px; max-height: 300px; margin-top: 1rem; }
        .tag-input { min-height: 100px; }
        .upload-form-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        /* Placeholder styles for better visibility */
        .form-control::placeholder {
            color: rgba(255, 255, 255, 0.7) !important;
            opacity: 1;
        }
        .form-control::-webkit-input-placeholder {
            color: rgba(255, 255, 255, 0.7) !important;
        }
        .form-control:-ms-input-placeholder {
            color: rgba(255, 255, 255, 0.7) !important;
        }
        /* Input text color */
        .form-control {
            color: white !important;
            background-color: rgba(255, 255, 255, 0.1) !important;
        }
        /* Select dropdown text color */
        .form-select {
            color: white !important;
            background-color: rgba(255, 255, 255, 0.1) !important;
        }
        .form-select option {
            background-color: #212529;
            color: white;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar Container -->
    <div id="nav-container"></div>

    <section class="py-5 galaxy" style="padding-top: 150px !important;">
        <div class="container">
            <h1 class="text-center mb-5 ms-madi-bold" data-aos="fade-up">Artwork Upload Tool</h1>
            <div class="upload-form-container" data-aos="fade-up" data-aos-delay="100">
        
            <form id="artworkForm" class="needs-validation" novalidate>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="card h-100 bg-dark text-white">
                            <div class="card-body">
                                <label for="imageFile" class="form-label">
                                    <i class="fas fa-image me-2"></i>Artwork Image
                                </label>
                                <input type="file" class="form-control" id="imageFile" accept="image/*" required>
                                <img id="imagePreview" class="preview-image d-none mt-3 rounded">
                                <div class="form-text text-light mt-2">
                                    <i class="fas fa-info-circle me-2"></i>Note: This is only for metadata. Upload the actual image to GitHub.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 mb-3">
                        <div class="card h-100 bg-dark text-white">
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-md-8">
                                        <label for="title" class="form-label">
                                            <i class="fas fa-heading me-2"></i>Title
                                        </label>
                                        <input type="text" class="form-control" id="title" required>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="createdDate" class="form-label">
                                            <i class="fas fa-calendar me-2"></i>Created Date
                                        </label>
                                        <input type="date" class="form-control" id="createdDate" required>
                                    </div>
                                </div>
                            </div>

                            <div class="card-body">
                                <label for="medium" class="form-label">
                                    <i class="fas fa-paint-brush me-2"></i>Medium
                                </label>
                                <select class="form-select" id="medium" required>
                                    <option value="">Select medium...</option>
                                    <option value="Sketch">Sketch</option>
                                    <option value="Painting">Painting</option>
                                    <option value="Illustration">Illustration</option>
                                </select>
                            </div>

                            <div class="card-body">
                                <label for="tags" class="form-label">
                                    <i class="fas fa-tags me-2"></i>Tags
                                </label>
                                <textarea class="form-control tag-input" id="tags" 
                                    placeholder="Enter tags separated by commas (e.g., Character, Fan Art, Game)" required></textarea>
                            </div>

                            <div class="card-body">
                                <label for="description" class="form-label">
                                    <i class="fas fa-align-left me-2"></i>Full Description
                                </label>
                                <textarea class="form-control" id="description" rows="4" required></textarea>
                            </div>
                        </div>
                    </div>

                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="fas fa-save me-2"></i>Save Gallery Data
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>

<!-- Footer Container -->
<div id="footer-container"></div>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Bootstrap JS Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- AOS Animation JS -->
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

<!-- Custom JS -->
<script src="../global/js/components-loader.js"></script>
<script src="../resources/js/card-effects.js"></script>

<script>
    // Initialize AOS animations
    AOS.init({
        duration: 1000,
        once: true
    });

    let galleryData = {
            artworks: []
        };
        
        // Load existing gallery data
        fetch('/resources/data/gallery-data.json')
            .then(response => response.json())
            .then(data => {
                galleryData = data;
            })
            .catch(error => console.error('Error loading gallery data:', error));

        // Image preview and metadata extraction
        document.getElementById('imageFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                // Preview image
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('imagePreview');
                    preview.src = e.target.result;
                    preview.classList.remove('d-none');
                };
                reader.readAsDataURL(file);

                // Extract and format title from filename
                const fileName = file.name;
                const titleWithoutExt = fileName.replace(/\.[^/.]+$/, ""); // Remove extension
                const formattedTitle = titleWithoutExt
                    .replace(/_/g, ' ')
                    .replace(/-/g, ' ')
                    .replace(/([0-9]{4})[-_]?([0-9]{2})[-_]?([0-9]{2})[-_]?([0-9]{6,})/g, '') // Remove date-time stamps
                    .replace(/\s+/g, ' ')
                    .trim()
                    // Capitalize first letter of each word
                    .split(' ')
                    .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                    .join(' ');
                
                document.getElementById('title').value = formattedTitle;

                // Set created date from file's last modified date
                const modifiedDate = new Date(file.lastModified);
                const formattedDate = modifiedDate.toISOString().split('T')[0]; // Format as YYYY-MM-DD
                document.getElementById('createdDate').value = formattedDate;
            }
        });

        // Form submission and data download
        document.getElementById('artworkForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newArtwork = {
                id: (galleryData.artworks.length + 1).toString(),
                title: document.getElementById('title').value,
                medium: document.getElementById('medium').value,
                tags: document.getElementById('tags').value.split(',').map(tag => tag.trim()).filter(tag => tag),
                imagePath: document.getElementById('imageFile').files[0].name,
                createdDate: document.getElementById('createdDate').value,
                fullDescription: document.getElementById('description').value
            };

            galleryData.artworks.push(newArtwork);
            
            // Download the updated gallery data
            const dataStr = JSON.stringify(galleryData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'gallery-data.json';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);

            // Reset form
            this.reset();
            document.getElementById('imagePreview').classList.add('d-none');
            alert('Artwork saved and gallery data downloaded successfully!');
        });
    </script>
</body>
</html>
